---
title: "NVIDIA Agent Morpheus - CVE Analysis at Enterprise Scale"
company: "NVIDIA"
author: "Bartley Richardson, Nicola Sessions, Michael Demoret, Rachel Allen, Hsin Chen"
source: "https://developer.nvidia.com/blog/applying-generative-ai-for-cve-analysis-at-an-enterprise-scale/"
date: "2024-05"
category: "Development & Engineering"
tags: ["multi-agent", "security-analysis", "event-driven", "production", "workflow-automation", "rag"]
description: "Reduced CVE triage from hours/days to seconds with 9.3x speedup through event-driven multi-agent system analyzing vulnerability exploit ability at enterprise scale"
problemPattern: "workflow-automation"
problemComplexity: "complex"

# Architecture
architecture:
  type: "multi-agent"
  pattern: "event-driven-workflow"
  rationale: "Event-driven RAG workflow with 4 specialized Llama3 LLMs (3 LoRA fine-tuned) enables autonomous CVE analysis without human prompting - planning LLM generates unique checklist, agent LLM executes tasks, summarization LLM combines results, VEX LLM standardizes justifications"
  components: ["planning-llm", "agent-llm", "summarization-llm", "vex-justification-llm", "custom-tools", "parallel-orchestration"]

# What Made It Work
breakthroughInsight: "Event-driven architecture enables massive parallelization - unlike traditional chatbot pipelines limited by human response time, Agent Morpheus independently processes CVEs and checklist items in parallel, achieving 9.3x speedup (2842s→305s for 20 CVEs)"

criticalConstraints:
  - "enterprise-scale-volumes"
  - "hundreds-of-thousands-of-cves"
  - "complex-software-dependencies"
  - "accuracy-critical-security"

antiPatterns:
  - "automated-patching-only: unrealistic for enterprise-scale - updated package versions often unavailable or break dependency chains"
  - "signature-scanning-only: doesn't differentiate between vulnerable (CVE present) and exploitable (can be executed)"

# Tech Stack
techStack:
  framework: "morpheus-cybersecurity-framework"
  llmProvider: "nvidia-nim"
  knowledgeRetrieval: "rag-multi-source"
  otherTools: ["llama3-lora-finetuning", "version-comparator", "calculator-tools", "sbom-analysis"]

# Scale
scale:
  volume: "enterprise container registry - dozens of CVEs per container, thousands of LLM requests"
  latency: "seconds per container (was hours/days manually), 9.3x parallel speedup"
---

# NVIDIA Agent Morpheus - CVE Analysis at Enterprise Scale

## The Problem

NVIDIA's software development teams faced an overwhelming vulnerability management challenge as the CVE database hit record highs with over 200,000 cumulative vulnerabilities by end of 2023. Investigating each CVE to determine exploitability and best remediation path was incredibly labor-intensive, tedious work requiring manual synthesis of intelligence from multiple sources applied to specific software containers.

**The Manual Process:**
- Security analysts manually scanned containers for CVE signatures from vulnerability databases
- Investigated each detected CVE across multiple vulnerability and threat intelligence sources
- Retrieved and analyzed software bill of materials (SBOMs), source code, and documentation
- Determined if CVE was actually exploitable in the specific container context (vs. merely present)
- Researched whether vulnerable library required missing dependencies (e.g., .jar files without JRE)
- Checked if vulnerable code/functions were accessible or used by the software
- Synthesized findings into standardized VEX (Vulnerability Exploitability eXchange) documents
- Hours to days spent per container before confident security sign-off for publishing

**Key Pain Points:**
- Traditional scanning and patching became unmanageable with exponentially increasing CVE volumes
- Automated remediation unrealistic - updated package versions often unavailable from maintainers
- Complex dependency chains meant updating one package could break software through compatibility issues
- False positives from signature scanning wasted analyst time investigating non-existent vulnerabilities
- Differentiating between "vulnerable" (CVE present) and "exploitable" (can be executed) required deep expertise
- Enterprise software publishing delayed while waiting for every CVE to be fixed (often impossible)
- Each CVE required unique investigation process based on specific vulnerability characteristics

## The Solution

NVIDIA built Agent Morpheus, an event-driven multi-agent system combining retrieval-augmented generation (RAG) with 4 specialized Llama3 LLMs to autonomously analyze CVE exploitability. The system generates unique investigation checklists per CVE, executes tasks independently without human prompting, and produces standardized VEX justifications—reducing triage time from hours/days to seconds.

**Impact**:
- **Reduced triage time from hours or days to seconds** per container
- **9.3x speedup through parallelization** - processing 20 CVEs dropped from 2842s to 305s
- **~41 LLM queries per CVE** handled efficiently through event-driven architecture
- **Fully automated workflow** triggered by container upload events, keeping pace with enterprise publishing demands
- Successfully deployed across NVIDIA's container registry at enterprise scale
- Continuous improvement through human feedback loop retraining models

## How It Works

**Key Capabilities:**
- **Event-Driven Workflow** - Container upload automatically triggers CVE analysis without human prompting
- **Multi-Agent System** - 4 specialized Llama3 LLMs (3 LoRA fine-tuned): planning, agent execution, summarization, VEX justification
- **Autonomous Checklist Generation** - Planning LLM creates unique task list per CVE based on vulnerability characteristics
- **Independent Task Execution** - Agent LLM retrieves data from SBOMs, source code, threat intelligence and executes checklist
- **Custom Tool Access** - Version comparator, calculator, and other tools overcome LLM limitations (e.g., comparing v1.9.1 vs v1.10)
- **Massive Parallelization** - CVEs and checklist items processed concurrently using Morpheus orchestration
- **Human-in-the-Loop Review** - Analysts review AI-generated summaries and make final recommendations
- **Continuous Learning** - Analyst feedback compiled into training datasets to retrain models

**Process Flow:**
1. Developer pushes new container to NVIDIA's container registry
2. Container upload event triggers immediate CVE scan using Anchore scanner
3. Scan results (list of CVEs) passed to Agent Morpheus service
4. System retrieves up-to-date vulnerability and threat intelligence for each CVE
5. Planning LLM (LoRA fine-tuned) generates unique checklist for determining exploitability
6. Agent LLM executes checklist items accessing SBOMs, source code, documentation, internet search
7. Agent uses custom tools (version comparator) to overcome LLM weaknesses with mathematical calculations
8. Summarization LLM combines all checklist results into coherent analysis
9. VEX LLM standardizes justifications into machine-readable VEX document format
10. Results sent to security analyst dashboard for review with original scan report
11. Analyst reviews AI summary, makes final recommendation, submits for peer review
12. After peer review, final VEX document published and distributed with container
13. Any analyst changes compiled into new training dataset for model improvement

**Technical Architecture:** Built on NVIDIA Morpheus cybersecurity framework enabling pipeline orchestration of thousands of LLM requests executed asynchronously and in parallel. Uses NVIDIA NIM inference microservices to host all 4 Llama3 models in single container with dynamic LoRA adapter loading. Event-driven design overcomes traditional chatbot pipeline limitations where human response time creates bottlenecks—Agent Morpheus runs independently without waiting for analysts.

**Specialized LLM Roles:** (1) Planning LLM generates CVE-specific checklists (e.g., "Check if software project has JRE required to execute vulnerable .jar file"), (2) Agent LLM autonomously executes checklist with access to software assets and custom tools, (3) Summarization LLM synthesizes findings across checklist items, (4) VEX LLM formats justifications into standardized machine-readable documents for distribution.

**Parallel Execution Example:** For a container with 20 CVEs generating ~820 LLM requests (41 per CVE), serial processing takes 2842 seconds. With Morpheus parallel orchestration, same workload completes in 305 seconds—9.3x speedup since CVEs and their checklist items are completely independent.

## Key Insight

**Event-driven architecture with parallelization is critical for enterprise-scale AI workflows** - Unlike traditional chatbot pipelines limited by human response time, Agent Morpheus processes CVEs and checklist items completely independently and in parallel. This architectural choice enabled 9.3x speedup and made the system capable of handling the "bursty nature" of thousands of outstanding LLM requests generated by single container scans.

**Why This Matters:**
- Traditional chatbot architectures fundamentally bottlenecked by human-in-the-loop latency
- Event-driven design enables applying same parallelization techniques as traditional ML pipelines to LLM workflows
- Custom tools (version comparators, calculators) essential for overcoming known LLM weaknesses in production
- Multi-agent specialization (planning, execution, summarization, formatting) outperforms general-purpose models
- Continuous learning from human feedback creates virtuous cycle of model improvement
- LoRA fine-tuning for specialized tasks delivers production quality without full model retraining costs

**Critical Design Principles:**
- Build event-driven workflows that don't wait for human prompts between steps
- Identify independent tasks that can execute in parallel rather than forcing sequential chains
- Provide agents with custom tools to overcome LLM limitations (math, version comparisons)
- Specialize models for distinct roles (planning vs execution vs summarization) through LoRA
- Design for variable workload - NIM handles bursty requests from thousands of LLM queries per container
- Maintain human review for final decisions while automating investigation grunt work
- Feed analyst corrections back into training data for continuous improvement

## Links

- [Applying Generative AI for CVE Analysis at an Enterprise Scale](https://developer.nvidia.com/blog/applying-generative-ai-for-cve-analysis-at-an-enterprise-scale/) - Original NVIDIA technical blog post
- [How to Apply Generative AI to Improve Cybersecurity](https://www.nvidia.com/gtc/session-catalog/?search=Bartley%20Richardson#/) - GTC session by Bartley Richardson
- [NVIDIA Morpheus Cybersecurity Framework](https://github.com/nv-morpheus/Morpheus) - Open-source framework used for orchestration
